@page
@{
    Layout = "~/Pages/Shared/Layout.cshtml"; // Указываем путь к макету
    ViewData["Title"] = "Diseases List";
}

<h1>Diseases List</h1>

<div id="diseases-container">
    <!-- Данные будут загружены сюда через JS -->
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.4.0/axios.min.js"></script>
<script>
    const apiBaseUrl = "/api/diseases";

    async function loadDiseases() {
        try {
            const response = await axios.get(apiBaseUrl);
            renderDiseases(response.data);
        } catch (error) {
            console.error("Error fetching diseases:", error);
            document.getElementById("diseases-container").innerHTML = 
                `<p>Error loading diseases. Please try again later.</p>`;
        }
    }

    function renderDiseases(diseases) {
        const container = document.getElementById("diseases-container");
        container.innerHTML = "";

        if (diseases.length === 0) {
            container.innerHTML = "<p>No diseases found.</p>";
            return;
        }

        const table = document.createElement("table");
        table.border = "1";
        table.style.width = "100%";
        table.style.borderCollapse = "collapse";
        table.innerHTML = `
            <thead>
                <tr>
                    <th style="padding: 8px; text-align: left;">Name</th>
                    <th style="padding: 8px; text-align: left;">Duration</th>
                    <th style="padding: 8px; text-align: left;">Symptoms</th>
                    <th style="padding: 8px; text-align: left;">Consequences</th>
                </tr>
            </thead>
            <tbody>
                ${diseases.map(disease => `
                    <tr>
                        <td style="padding: 8px;">${disease.name}</td>
                        <td style="padding: 8px;">${disease.duration}</td>
                        <td style="padding: 8px;">${disease.symptoms}</td>
                        <td style="padding: 8px;">${disease.consequences}</td>
                    </tr>
                `).join('')}
            </tbody>
        `;

        container.appendChild(table);
    }

    loadDiseases();
</script>
